<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Email Spam Detector</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
  <h1>Email Spam Detector</h1>
  <div>
    <input type="file" id="file-input" style="display:none">
    <div id="drop-zone" style="border: 2px dashed; width: 300px; height: 200px; text-align: center; line-height: 200px;">
      Drag and drop an image here or click to choose
    </div>
  </div>
  <div id="result" style="display:none">
    <h2>Spam Score: <span id="spam-score"></span></h2>
  </div>
  <script>
    $("#drop-zone").on("click", function () {
      $("#file-input").trigger("click");
    });

    $("#file-input").on("change", function (e) {
        var file = e.target.files[0];
      if (file) {
        var reader = new FileReader();
        reader.onload = function (e) {
          var image = e.target.result;
          $("#drop-zone").css("background-image", "url(" + image + ")");
          $("#drop-zone").css("background-size", "cover");
          $("#drop-zone").css("background-position", "center");
          $("#drop-zone").css("line-height", "0px");
          uploadImage(file);
        };
        reader.readAsDataURL(file);
      }
    });

    function uploadImage(file) {
      var formData = new FormData();
      formData.append("file", file);
      $.ajax({
        url: "/upload",
        type: "POST",
        data: formData,
        processData: false,
        contentType: false,
        success: function (response) {
          if (response.spam_score !== undefined) {
            $("#spam-score").text(response.spam_score);
            $("#result").show();
          } else {
            $("#result").hide();
          }
        },
        error: function () {
          $("#result").hide();
        }
      });
    }
  </script>
</body>
</html>
